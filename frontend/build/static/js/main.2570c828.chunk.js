(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{12:function(t,e,r){"use strict";var n=function(){var t="https://api.spotify.com/v1",e=null,r=null,o=function(t,e){return t.abort=e,t},a=function(){var t=Array.prototype.slice.call(arguments),e=t[0],r=t.slice(1);return e=e||{},r.forEach((function(t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})),e},u=function(t,n){var a=new XMLHttpRequest,u=function(r,o){var u=t.type||"GET";if(a.open(u,function(t,e){var r="";for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];r+=encodeURIComponent(n)+"="+encodeURIComponent(o)+"&"}return r.length>0&&(t=t+"?"+(r=r.substring(0,r.length-1))),t}(t.url,t.params)),e&&a.setRequestHeader("Authorization","Bearer "+e),t.contentType&&a.setRequestHeader("Content-Type",t.contentType),a.onreadystatechange=function(){if(4===a.readyState){var t=null;try{t=a.responseText?JSON.parse(a.responseText):""}catch(e){console.error(e)}a.status>=200&&a.status<300?function(t){r&&r(t),n&&n(null,t)}(t):(o&&o(a),n&&n(a,null))}},"GET"===u)a.send(null);else{var s=null;t.postData&&(s="image/jpeg"===t.contentType?t.postData:JSON.stringify(t.postData)),a.send(s)}};return n?(u(),null):function(t,e){var n;if(null!==r){var a=r.defer();t((function(t){a.resolve(t)}),(function(t){a.reject(t)})),n=a.promise}else window.Promise&&(n=new window.Promise(t));return n?new o(n,e):null}(u,(function(){a.abort()}))},s=function(t,e,r,n){var o={},s=null;return"object"===typeof e?(o=e,s=r):"function"===typeof e&&(s=e),"GET"!==(t.type||"GET")&&t.postData&&!n?t.postData=a(t.postData,o):t.params=a(t.params,o),u(t,s)},c=function(){};return(c.prototype={constructor:n}).getGeneric=function(t,e){return s({url:t},e)},c.prototype.getMe=function(e,r){return s({url:t+"/me"},e,r)},c.prototype.getMySavedTracks=function(e,r){return s({url:t+"/me/tracks"},e,r)},c.prototype.addToMySavedTracks=function(e,r,n){return s({url:t+"/me/tracks",type:"PUT",postData:e},r,n)},c.prototype.removeFromMySavedTracks=function(e,r,n){return s({url:t+"/me/tracks",type:"DELETE",postData:e},r,n)},c.prototype.containsMySavedTracks=function(e,r,n){var o={url:t+"/me/tracks/contains",params:{ids:e.join(",")}};return s(o,r,n)},c.prototype.getMySavedAlbums=function(e,r){return s({url:t+"/me/albums"},e,r)},c.prototype.addToMySavedAlbums=function(e,r,n){return s({url:t+"/me/albums",type:"PUT",postData:e},r,n)},c.prototype.removeFromMySavedAlbums=function(e,r,n){return s({url:t+"/me/albums",type:"DELETE",postData:e},r,n)},c.prototype.containsMySavedAlbums=function(e,r,n){var o={url:t+"/me/albums/contains",params:{ids:e.join(",")}};return s(o,r,n)},c.prototype.getMyTopArtists=function(e,r){return s({url:t+"/me/top/artists"},e,r)},c.prototype.getMyTopTracks=function(e,r){return s({url:t+"/me/top/tracks"},e,r)},c.prototype.getMyRecentlyPlayedTracks=function(e,r){return s({url:t+"/me/player/recently-played"},e,r)},c.prototype.followUsers=function(e,r){var n={url:t+"/me/following/",type:"PUT",params:{ids:e.join(","),type:"user"}};return s(n,r)},c.prototype.followArtists=function(e,r){var n={url:t+"/me/following/",type:"PUT",params:{ids:e.join(","),type:"artist"}};return s(n,r)},c.prototype.followPlaylist=function(e,r,n){return s({url:t+"/playlists/"+e+"/followers",type:"PUT",postData:{}},r,n)},c.prototype.unfollowUsers=function(e,r){var n={url:t+"/me/following/",type:"DELETE",params:{ids:e.join(","),type:"user"}};return s(n,r)},c.prototype.unfollowArtists=function(e,r){var n={url:t+"/me/following/",type:"DELETE",params:{ids:e.join(","),type:"artist"}};return s(n,r)},c.prototype.unfollowPlaylist=function(e,r){return s({url:t+"/playlists/"+e+"/followers",type:"DELETE"},r)},c.prototype.isFollowingUsers=function(e,r){var n={url:t+"/me/following/contains",type:"GET",params:{ids:e.join(","),type:"user"}};return s(n,r)},c.prototype.isFollowingArtists=function(e,r){var n={url:t+"/me/following/contains",type:"GET",params:{ids:e.join(","),type:"artist"}};return s(n,r)},c.prototype.areFollowingPlaylist=function(e,r,n){var o={url:t+"/playlists/"+e+"/followers/contains",type:"GET",params:{ids:r.join(",")}};return s(o,n)},c.prototype.getFollowedArtists=function(e,r){return s({url:t+"/me/following",type:"GET",params:{type:"artist"}},e,r)},c.prototype.getUser=function(e,r,n){var o={url:t+"/users/"+encodeURIComponent(e)};return s(o,r,n)},c.prototype.getUserPlaylists=function(e,r,n){var o;return"string"===typeof e?o={url:t+"/users/"+encodeURIComponent(e)+"/playlists"}:(o={url:t+"/me/playlists"},n=r,r=e),s(o,r,n)},c.prototype.getPlaylist=function(e,r,n){return s({url:t+"/playlists/"+e},r,n)},c.prototype.getPlaylistTracks=function(e,r,n){return s({url:t+"/playlists/"+e+"/tracks"},r,n)},c.prototype.getPlaylistCoverImage=function(e,r){return s({url:t+"/playlists/"+e+"/images"},r)},c.prototype.createPlaylist=function(e,r,n){var o={url:t+"/users/"+encodeURIComponent(e)+"/playlists",type:"POST",postData:r};return s(o,r,n)},c.prototype.changePlaylistDetails=function(e,r,n){return s({url:t+"/playlists/"+e,type:"PUT",postData:r},r,n)},c.prototype.addTracksToPlaylist=function(e,r,n,o){return s({url:t+"/playlists/"+e+"/tracks",type:"POST",postData:{uris:r}},n,o,!0)},c.prototype.replaceTracksInPlaylist=function(e,r,n){return s({url:t+"/playlists/"+e+"/tracks",type:"PUT",postData:{uris:r}},{},n)},c.prototype.reorderTracksInPlaylist=function(e,r,n,o,a){return s({url:t+"/playlists/"+e+"/tracks",type:"PUT",postData:{range_start:r,insert_before:n}},o,a)},c.prototype.removeTracksFromPlaylist=function(e,r,n){var o=r.map((function(t){return"string"===typeof t?{uri:t}:t}));return s({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{tracks:o}},{},n)},c.prototype.removeTracksFromPlaylistWithSnapshotId=function(e,r,n,o){var a=r.map((function(t){return"string"===typeof t?{uri:t}:t}));return s({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{tracks:a,snapshot_id:n}},{},o)},c.prototype.removeTracksFromPlaylistInPositions=function(e,r,n,o){return s({url:t+"/playlists/"+e+"/tracks",type:"DELETE",postData:{positions:r,snapshot_id:n}},{},o)},c.prototype.uploadCustomPlaylistCoverImage=function(e,r,n){var o={url:t+"/playlists/"+e+"/images",type:"PUT",postData:r.replace(/^data:image\/jpeg;base64,/,""),contentType:"image/jpeg"};return s(o,{},n)},c.prototype.getAlbum=function(e,r,n){return s({url:t+"/albums/"+e},r,n)},c.prototype.getAlbumTracks=function(e,r,n){return s({url:t+"/albums/"+e+"/tracks"},r,n)},c.prototype.getAlbums=function(e,r,n){var o={url:t+"/albums/",params:{ids:e.join(",")}};return s(o,r,n)},c.prototype.getTrack=function(e,r,n){var o={};return o.url=t+"/tracks/"+e,s(o,r,n)},c.prototype.getTracks=function(e,r,n){var o={url:t+"/tracks/",params:{ids:e.join(",")}};return s(o,r,n)},c.prototype.getArtist=function(e,r,n){return s({url:t+"/artists/"+e},r,n)},c.prototype.getArtists=function(e,r,n){var o={url:t+"/artists/",params:{ids:e.join(",")}};return s(o,r,n)},c.prototype.getArtistAlbums=function(e,r,n){return s({url:t+"/artists/"+e+"/albums"},r,n)},c.prototype.getArtistTopTracks=function(e,r,n,o){return s({url:t+"/artists/"+e+"/top-tracks",params:{country:r}},n,o)},c.prototype.getArtistRelatedArtists=function(e,r,n){return s({url:t+"/artists/"+e+"/related-artists"},r,n)},c.prototype.getFeaturedPlaylists=function(e,r){return s({url:t+"/browse/featured-playlists"},e,r)},c.prototype.getNewReleases=function(e,r){return s({url:t+"/browse/new-releases"},e,r)},c.prototype.getCategories=function(e,r){return s({url:t+"/browse/categories"},e,r)},c.prototype.getCategory=function(e,r,n){return s({url:t+"/browse/categories/"+e},r,n)},c.prototype.getCategoryPlaylists=function(e,r,n){return s({url:t+"/browse/categories/"+e+"/playlists"},r,n)},c.prototype.search=function(e,r,n,o){var a={url:t+"/search/",params:{q:e,type:r.join(",")}};return s(a,n,o)},c.prototype.searchAlbums=function(t,e,r){return this.search(t,["album"],e,r)},c.prototype.searchArtists=function(t,e,r){return this.search(t,["artist"],e,r)},c.prototype.searchTracks=function(t,e,r){return this.search(t,["track"],e,r)},c.prototype.searchPlaylists=function(t,e,r){return this.search(t,["playlist"],e,r)},c.prototype.searchShows=function(t,e,r){return this.search(t,["show"],e,r)},c.prototype.searchEpisodes=function(t,e,r){return this.search(t,["episode"],e,r)},c.prototype.getAudioFeaturesForTrack=function(e,r){var n={};return n.url=t+"/audio-features/"+e,s(n,{},r)},c.prototype.getAudioFeaturesForTracks=function(e,r){return s({url:t+"/audio-features",params:{ids:e}},{},r)},c.prototype.getAudioAnalysisForTrack=function(e,r){var n={};return n.url=t+"/audio-analysis/"+e,s(n,{},r)},c.prototype.getRecommendations=function(e,r){return s({url:t+"/recommendations"},e,r)},c.prototype.getAvailableGenreSeeds=function(e){return s({url:t+"/recommendations/available-genre-seeds"},{},e)},c.prototype.getMyDevices=function(e){return s({url:t+"/me/player/devices"},{},e)},c.prototype.getMyCurrentPlaybackState=function(e,r){return s({url:t+"/me/player"},e,r)},c.prototype.getMyCurrentPlayingTrack=function(e,r){return s({url:t+"/me/player/currently-playing"},e,r)},c.prototype.transferMyPlayback=function(e,r,n){var o=r||{};return o.device_ids=e,s({type:"PUT",url:t+"/me/player",postData:o},r,n)},c.prototype.play=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null,o={};return["context_uri","uris","offset","position_ms"].forEach((function(t){t in e&&(o[t]=e[t])})),s({type:"PUT",url:t+"/me/player/play",params:n,postData:o},"function"===typeof e?e:{},r)},c.prototype.pause=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null;return s({type:"PUT",url:t+"/me/player/pause",params:n},e,r)},c.prototype.skipToNext=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null;return s({type:"POST",url:t+"/me/player/next",params:n},e,r)},c.prototype.skipToPrevious=function(e,r){var n="device_id"in(e=e||{})?{device_id:e.device_id}:null;return s({type:"POST",url:t+"/me/player/previous",params:n},e,r)},c.prototype.seek=function(e,r,n){var o={position_ms:e};return"device_id"in(r=r||{})&&(o.device_id=r.device_id),s({type:"PUT",url:t+"/me/player/seek",params:o},r,n)},c.prototype.setRepeat=function(e,r,n){var o={state:e};return"device_id"in(r=r||{})&&(o.device_id=r.device_id),s({type:"PUT",url:t+"/me/player/repeat",params:o},r,n)},c.prototype.setVolume=function(e,r,n){var o={volume_percent:e};return"device_id"in(r=r||{})&&(o.device_id=r.device_id),s({type:"PUT",url:t+"/me/player/volume",params:o},r,n)},c.prototype.setShuffle=function(e,r,n){var o={state:e};return"device_id"in(r=r||{})&&(o.device_id=r.device_id),s({type:"PUT",url:t+"/me/player/shuffle",params:o},r,n)},c.prototype.getShow=function(e,r,n){var o={};return o.url=t+"/shows/"+e,s(o,r,n)},c.prototype.getShows=function(e,r,n){var o={url:t+"/shows/",params:{ids:e.join(",")}};return s(o,r,n)},c.prototype.getMySavedShows=function(e,r){return s({url:t+"/me/shows"},e,r)},c.prototype.addToMySavedShows=function(e,r,n){return s({url:t+"/me/shows",type:"PUT",postData:e},r,n)},c.prototype.removeFromMySavedShows=function(e,r,n){return s({url:t+"/me/shows",type:"DELETE",postData:e},r,n)},c.prototype.containsMySavedShows=function(e,r,n){var o={url:t+"/me/shows/contains",params:{ids:e.join(",")}};return s(o,r,n)},c.prototype.getShowEpisodes=function(e,r,n){return s({url:t+"/shows/"+e+"/episodes"},r,n)},c.prototype.getEpisode=function(e,r,n){var o={};return o.url=t+"/episodes/"+e,s(o,r,n)},c.prototype.getEpisodes=function(e,r,n){var o={url:t+"/episodes/",params:{ids:e.join(",")}};return s(o,r,n)},c.prototype.getAccessToken=function(){return e},c.prototype.setAccessToken=function(t){e=t},c.prototype.setPromiseImplementation=function(t){var e=!1;try{var n=new t((function(t){t()}));"function"===typeof n.then&&"function"===typeof n.catch&&(e=!0)}catch(o){console.error(o)}if(!e)throw new Error("Unsupported implementation of Promises/A+");r=t},c}();"object"===typeof t.exports&&(t.exports=n)},21:function(t,e,r){t.exports=r(39)},26:function(t,e,r){},27:function(t,e,r){},28:function(t,e,r){},29:function(t,e,r){},31:function(t,e,r){},37:function(t,e,r){},38:function(t,e,r){},39:function(t,e,r){"use strict";r.r(e);var n=r(0),o=r.n(n),a=r(19),u=r.n(a),s=(r(26),r(1)),c=r(10),i=(r(27),function(t){return o.a.createElement("header",{className:"navigation"},o.a.createElement("span",{className:"navigation-title"},"mySoundJourney"),o.a.createElement("span",{className:"navigation-shoutout"},"powered ",o.a.createElement("span",{role:"img","aria-label":"!"},"\ud83d\udcaa\ud83c\udffd")," by Spotify\xae API"))}),l=(r(28),function(t){var e=document.location.href;return o.a.createElement("div",{className:"auth-container"},o.a.createElement("h2",{className:"auth-container__description"},"Get started by authorizing yourself with Spotify"),o.a.createElement("a",{className:"auth-container__button",href:"".concat(e,"auth/login")},"CONNECT TO SPOTIFY"))}),p=(r(29),function(t){return o.a.createElement("footer",{className:"main-footer"},o.a.createElement("span",{className:"main-footer-author"},"\xa9 2020 Sanjay Alwani"),o.a.createElement("span",{className:"main-footer-nav"},o.a.createElement("span",null,"About"),o.a.createElement("span",null,"Feedback")))}),y=r(3),f=r.n(y),m=r(7),d=r(15),v=(r(31),function(t){return o.a.createElement("ul",{className:"navigation-links"},o.a.createElement("li",null,o.a.createElement(c.b,{to:"/journey"},"JOURNEY")))}),g=(r(37),function(t){return o.a.createElement("div",{className:"page-container"},o.a.createElement(v,null),t.children)}),h=r(12),E=r.n(h),k=(Object(n.createContext)({isLoggedIn:!1,access_token:"",refresh_token:"",login:function(){},logout:function(){}}),function(t){return Math.floor(128-127*Math.cos(Math.PI*t))}),b=function(t){var e,r,n=t.trackObject.track;return o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("img",{src:n.album.images[2].url,alt:"Album: ".concat(n.album.name)})),o.a.createElement("td",null,"".concat(n.name," by ").concat(n.artists[0].name)),o.a.createElement("td",null,function(t){var e=t/1e3,r=Math.floor(e/60);return e=Math.floor(e%60),"".concat(r,":").concat(e<10?"0".concat(e):e)}(n.duration_ms)),o.a.createElement("td",{style:{fontSize:"".concat((r=n.popularity,.4+r/80),"em")}},n.popularity),o.a.createElement("td",{style:{backgroundColor:"rgba(".concat(k(t.trackObject.energy),",30,").concat(255-k(t.trackObject.energy),",0.6)")}},"".concat(Math.round(1e4*t.trackObject.energy)/100,"%")),o.a.createElement("td",{style:{backgroundColor:"rgba(".concat(k(t.trackObject.valence),",").concat((e=t.trackObject.valence,Math.floor(255*(1-Math.pow(e-1,2)))),",").concat(255-k(t.trackObject.valence),",0.6)")}},"".concat(Math.round(1e4*t.trackObject.valence)/100,"%")),o.a.createElement("td",null,t.trackObject.played_at))},T=(r(38),function(t){var e=t.recent_tracks;return console.log("Tracks object\n"),console.log(e[0]),o.a.createElement("table",{className:"journey-table"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Cover"),o.a.createElement("th",null,"Track Name + Artist"),o.a.createElement("th",null,"Runtime"),o.a.createElement("th",null,"Popularity"),o.a.createElement("th",null,"Energy"),o.a.createElement("th",null,"Positivity"),o.a.createElement("th",null,"Played at"))),o.a.createElement("tbody",null,e?e.map((function(t,e){return o.a.createElement(b,{trackObject:t,key:e})})):o.a.createElement("tr",null,o.a.createElement("td",null,"sorry"))))}),w=r(16),P=new E.a,j=function(){var t=Object(m.a)(f.a.mark((function t(){var e;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.getMyRecentlyPlayedTracks({limit:50}).then((function(t){e=t.items}),(function(t){console.error(t)}));case 2:return t.abrupt("return",e);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),_=function(){var t=Object(m.a)(f.a.mark((function t(e){var r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.getAudioFeaturesForTracks(e).then((function(t){r=t.audio_features}),(function(t){console.error(t)}));case 2:return t.abrupt("return",r);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),A=function(){var t=Object(m.a)(f.a.mark((function t(e){var r,n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P.setAccessToken(e),console.log("Getting journey data try "),t.next=5,j().then((function(t){return n=t,t})).then((function(t){if(t)return t.map((function(t){return t.track.id}));throw Error("No response 1")})).then(function(){var t=Object(m.a)(f.a.mark((function t(e){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(e).then((function(t){if(console.log(t),!n)throw Error("No response 2"+n);r=n.map((function(e,r){return Object(w.a)(Object(w.a)({},e),{},{energy:t[r].energy,valence:t[r].valence})}))}));case 2:t.sent;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){return console.error(t)}));case 5:return t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),S=function(){var t=Object(m.a)(f.a.mark((function t(e){var r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P.setAccessToken(e),t.next=3,P.getMe().then((function(t){r=t.display_name}),(function(t){console.error(t)}));case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=function(t){var e;console.log("Cookie => "+document.cookie),document.cookie.includes("acc_tok")&&(e=document.cookie.split("=")[1]);var r=Object(n.useState)(""),a=Object(d.a)(r,2),u=a[0],s=a[1],c=Object(n.useState)([]),i=Object(d.a)(c,2),l=i[0],p=i[1],y=function(){var t=Object(m.a)(f.a.mark((function t(){var r,n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S(e);case 2:return r=t.sent,s(r),t.next=6,A(e);case 6:n=t.sent,p(n);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(n.useEffect)((function(){return y()}),[]),o.a.createElement(g,null,o.a.createElement("p",null,"Welcome ",u||"Loading"),o.a.createElement("h2",null," Listening History "),l&&0===l.length&&o.a.createElement("span",null," Loading \u2022\u2022\u2022 "),l&&l.length>0&&o.a.createElement(T,{recent_tracks:l}))},D=!1;var M=function(){var t;return Object(n.useEffect)((function(){return!D&&document.cookie.includes("acc_tok")&&(document.cookie.split(";").find((function(t){return t.startsWith("acc_tok")})).split("=")[1],D=!0),console.log("Mounted"),function(){console.log("Cleaning up"),document.cookie=encodeURIComponent("acc_tok=;")}}),[]),!D&&document.cookie.includes("acc_tok")&&(document.cookie.split(";").find((function(t){return t.startsWith("acc_tok")})).split("=")[1],D=!0),t=D?o.a.createElement(s.d,null,o.a.createElement(s.b,{path:"/journey"},o.a.createElement(O,null)),o.a.createElement(s.b,{path:"/top/tracks"},o.a.createElement(O,null)),o.a.createElement(s.b,{path:"/top/artists"},o.a.createElement(O,null)),o.a.createElement(s.a,{to:"/journey"})):o.a.createElement(s.d,null,o.a.createElement(s.b,{path:"/",exact:!0},o.a.createElement(l,null)),o.a.createElement(s.a,{to:"/"})),o.a.createElement(c.a,null,o.a.createElement(i,null),o.a.createElement("main",null,t),o.a.createElement(p,null))};u.a.render(o.a.createElement(M,null),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.2570c828.chunk.js.map